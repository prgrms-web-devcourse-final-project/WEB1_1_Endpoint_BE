input {
  tcp {
      port => 5044       # Spring Boot의 Logback에서 보낸 포트
      codec => json_lines # JSON 형식으로 수신
  }
}

filter {
  if [message] =~ /^API Request/ {
      grok {
        match => { "message" => "API Request .*keyword:\s*(?<keyword>\S+)" }
      }
    }
}

output {
  stdout {              # 콘솔 출력 (테스트용)
    codec => rubydebug
  }

  elasticsearch {
                hosts => ["es:9200"]
                index => "logstash-%{+YYYY.MM.dd}"
                manage_template => true
        	template => "/usr/share/logstash/logstash.json"
        	template_name => "logstash"
        	template_overwrite => true
        }
}